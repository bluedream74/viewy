{% extends 'base.html' %}
{% load static %}
{% block static %}
<link rel="stylesheet" href="{% static 'css/stylecreate.css' %}">
{% endblock %}
{% block content %}
<div class="mid-logo">V</div>
<div class="sub-title">マンガを投稿する</div>


<div id="spinner"></div>
<div id="loading">投稿中です<br>この処理は数分かかる場合があります<br>投稿ボタンは一度だけ押してください</div>


<div class="forms">
  <form method="POST" enctype="multipart/form-data" id="submit-form">
    {% csrf_token %}
    <div class="error">
      {% for error in form.non_field_errors %}
          <div class="error">{{ error }}</div>
      {% endfor %}
  </div>
      {{ visual_form.as_div }}
      <div class="limit">※最大31ページまで</div>
      <div class="title">
        <div class="error">{{ form.title.errors }}</div> 
        {{ form.title }}
      </div>
      <div class="url">
        <div class="error">{{ form.url.errors }}</div>
        {{ form.url }}
      </div>
      <div class="hashtags">
        <div class="error">{{ form.hashtag1.errors }}</div>
        <div class="error">{{ form.hashtag2.errors }}</div>
        <div class="error">{{ form.hashtag3.errors }}</div>
      #{{ form.hashtag1 }}
      #{{ form.hashtag2 }}
      #{{ form.hashtag3 }}
      </div>
      <div class="caption">
        <div class="error">{{ form.caption.errors }}</div>
        {{ form.caption }}
      </div>
    <input class="button" type="submit" value="投稿する" id="submit-button">
  </form>
</div>

<div class="bottom-space"></div>

<style>
  .add-post{
    border-top: solid 2px aqua;
  }
</style>
<script>
  document.getElementById('submit-button').addEventListener('click', function(event) {
    // スピナーを表示
    document.getElementById('spinner').style.display = 'block';
    document.getElementById('loading').style.display = 'block';

    // 送信ボタンを無効化
    event.preventDefault();
    this.disabled = true;

    // フォーム送信
    document.getElementById('submit-form').submit();
  });
</script>
{% endblock %}
